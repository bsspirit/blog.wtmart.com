title: 中国债券市场日报`r as.character(Sys.Date())` 
date: `r as.character(Sys.time())` 
author: Weilin Lin
categories:
- 金融市场报告
- 债券货币市场
---

```{r initProject, include=FALSE}
library(datatools);

```

## 债券货币市场回顾
### 历史季节性走势回顾

```{r yieldCurveChange, include=FALSE}
options(warn = -2);
png              = bloomberg.gg.daily("Yr10", 20080101);
image.tmp        = "/home/amg/git/blog.wtmart.com/source/images/Yr10.png"
ggsave(png, file = image.tmp, width=8,height=5);

png              = bloomberg.gg.daily("Yr10_gk", 20080101);
image.tmp        = "/home/amg/git/blog.wtmart.com/source/images/Yr10_gk.png"
ggsave(png, file = image.tmp, width=8,height=5);

png              = bloomberg.gg.daily("Yr5_2ap_drzp", 20080101);
image.tmp        = "/home/amg/git/blog.wtmart.com/source/images/Yr5_2ap_drzp.png"
ggsave(png, file = image.tmp, width=8,height=5);

png              = bloomberg.gg.daily("Yr5_2a_drzp", 20080101);
image.tmp        = "/home/amg/git/blog.wtmart.com/source/images/Yr5_2a_drzp.png"
ggsave(png, file = image.tmp, width=8,height=5);

```

**图 1：10年期国债历史走势 ** 
* ------------------------------------- *
![债券市场回顾](/images/Yr10.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统

**图 2：10年期国开债历史走势 ** 
* ------------------------------------- *
![债券市场回顾](/images/Yr10_gk.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统

**图 3：5年期2A+短融中票历史走势** 
* ------------------------------------- *
![债券市场回顾](/images/Yr5_2ap_drzp.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统

**图 4：5年期2A短融中票历史走势** 
* ------------------------------------- *
![债券市场回顾](/images/Yr5_2a_drzp.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统


### 收益率曲线结构变化

```{r initYieldCurveProject, include=FALSE}
Sys.setenv(TEST = "yes");
source("/home/amg/svn/yieldCurve/profiling/Rprofile.R")
```

```{r, include=FALSE}
  date   <- date.currentDate();
  date   <- date.convert(date.toBusDate(date = date, region = "CN", shift = -1), format = "YYYYMMDD");
  dateL1 <- date.convert(date.toBusDate(date = date, region = "CN", shift = -1), format = "YYYYMMDD");
  dateL5 <- date.convert(date.toBusDate(date = date, region = "CN", shift = -5), format = "YYYYMMDD");
### Plot one week change 
  png("/home/amg/git/blog.wtmart.com/source/images/ycDiffWeek.png");
  startDate<- dateL5;
  endDate  <- date;
  ytmStart <- yieldCurve(startDate);
  ytmEnd   <- yieldCurve(endDate);
  yrMats   <- c(1,3,5,7,10);
  ytmStart <- ytmStart[ytmStart$YrMat%in%yrMats,];
  ytmEnd   <- ytmEnd[ytmEnd$YrMat%in%yrMats,];
  df       <- data.frame(YrMat=yrMats, YTMstart=ytmStart$YTM[match(yrMats, ytmStart$YrMat)],YTMend=ytmEnd$YTM[match(yrMats, ytmEnd$YrMat)]);  
  df <- df[order(df$YrMat),];
  df$YTMdiff <- df$YTMend-df$YTMstart;
  par(mfrow=c(2,1));
  ylims <- c(min(c(100*df$YTMstart,100*df$YTMend)),max(c(100*df$YTMstart,100*df$YTMend))); 
  plot(df$YrMat, 100*df$YTMstart, ty="o",xlab="",ylab="YTM(%)", main=p("yield to maturity: ",startDate,"-" ,endDate),xlim=c(0,12),xaxt="n",ylim=ylims,col="blue",lwd=2);
  text(df$YrMat, 100*df$YTMstart,p(round(100*df$YTMstart,2),"%"),col="blue")
  ii <- c(1,3,5,7,10);
  abline(v=ii, lty=2);
  axis(1, at=ii, labels=p("Yr",ii),las=0);
  points(df$YrMat, 100*df$YTMend,col="red");
  lines(df$YrMat, 100*df$YTMend, col="red",xlab="",ylab="",main="",xaxt="n",yaxt="n",lwd=2);  text(df$YrMat, 100*df$YTMend,p(round(100*df$YTMend,2),"%"),col = "red")
  df <- subset(df, YrMat%in%c(1,3,5,7,10));
  mp <- barplot(10000*df$YTMdiff,df$YrMat,col=rainbow(20),names.arg = df$YrMat,space=1.5,ylab="bps",width=1,legend.text=NULL);      
  abline(h=0, lwd=2);  
  colVecs <- ifelse(df$YTMdiff>0, "red", "blue");         
  text(mp, 1.1 * 10000*df$YTMdiff, round(10000*df$YTMdiff,2), xpd = TRUE, col = colVecs);  
  dev.off();

### Plot one day change
  png("/home/amg/git/blog.wtmart.com/source/images/ycDiffDay.png");
  startDate<- dateL1;
  endDate  <- date;
  ytmStart <- yieldCurve(startDate);
  ytmEnd   <- yieldCurve(endDate);
  yrMats   <- c(1,3,5,7,10);
  ytmStart <- ytmStart[ytmStart$YrMat%in%yrMats,];
  ytmEnd   <- ytmEnd[ytmEnd$YrMat%in%yrMats,];
  df       <- data.frame(YrMat=yrMats, YTMstart=ytmStart$YTM[match(yrMats, ytmStart$YrMat)],YTMend=ytmEnd$YTM[match(yrMats, ytmEnd$YrMat)]);  
  df <- df[order(df$YrMat),];
  df$YTMdiff <- df$YTMend-df$YTMstart;
  par(mfrow=c(2,1));
  ylims <- c(min(c(100*df$YTMstart,100*df$YTMend)),max(c(100*df$YTMstart,100*df$YTMend))); 
  plot(df$YrMat, 100*df$YTMstart, ty="o",xlab="",ylab="YTM(%)", main=p("yield to maturity: ",startDate,"-" ,endDate),xlim=c(0,12),xaxt="n",ylim=ylims,col="blue",lwd=2);
  ii <- c(1,3,5,7,10);
  abline(v=ii, lty=2);
  axis(1, at=ii, labels=p("Yr",ii),las=0);
  points(df$YrMat, 100*df$YTMend,col="red");
  lines(df$YrMat, 100*df$YTMend, col="red",xlab="",ylab="",main="",xaxt="n",yaxt="n",lwd=2);
  df <- subset(df, YrMat%in%c(1,3,5,7,10));
  mp <- barplot(10000*df$YTMdiff,df$YrMat,col=rainbow(20),names.arg = df$YrMat,space=1.5,ylab="bps",width=1,legend.text=NULL);      
  abline(h=0, lwd=2);  
  colVecs <- ifelse(df$YTMdiff>0, "red", "blue");         
  text(mp, 1.1 * 10000*df$YTMdiff, round(10000*df$YTMdiff,2), xpd = TRUE, col = colVecs);  
  dev.off();

### Plot of level, slope and Curvature
data  <- yieldCurveTwoFactor(20080101,date);
data  <- data[,c("date","level","slope.all","curvature.all")];
data  <- data[!duplicated(data$date), ];
data  <- xts(data[,c("level","slope.all","curvature.all")], date.convert(data$date));

png("/home/amg/git/blog.wtmart.com/source/images/ycDecompose2008.png",width=1000,height=500);
data2008  <- cumsum(data["2008::"]);
index     <- zoo::index;
chart.TimeSeries(data2008, legend.loc = "topleft",main="收益率曲线变动分解（%）");
dev.off();

png("/home/amg/git/blog.wtmart.com/source/images/ycDecompose2014.png",width=1000,height=500);
data2014  <- cumsum(data["2014::"]);
index     <- zoo::index;
chart.TimeSeries(data2014, legend.loc = "topleft",main="收益率曲线变动分解（%）");
dev.off();

```
**图 5：收益率曲线一天变化 ** 
* ------------------------------------- *
![债券市场回顾](/images/ycDiffDay.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统


**图 6：收益率曲线一周变化 ** 
* ------------------------------------- *
![债券市场回顾](/images/ycDiffWeek.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统

**图 7：收益率曲线变动分解 ** 
* ------------------------------------- *
![债券市场回顾](/images/ycDecompose2014.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统

**图 8：收益率曲线变动分解 ** 
* ------------------------------------- *
![债券市场回顾](/images/ycDecompose2008.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统

### 大类资产表现回顾
```{r assetPerformance, include=FALSE}
  date      <- date.currentDate();
  weekDate  <- date.convert(date.toBusDate(date = date, region = "CN", shift = -6), format = "YYYYMMDD");
  monthDate <- p(substring(date,1,6),"01");
  yearDate  <- p(substring(date,1,4),"0101");
  indexes   <- c("index_ConvertibleBond","index_GZ_Yr1_Yr3","index_GZ_Yr3_Yr5",
                 "index_GZ_Yr5_Yr7", "index_GZ_Yr7_Yr10","index_JR_Yr1_Yr3",
                 "index_JR_Yr3_Yr5", "index_JR_Yr5_Yr7", "index_JR_Yr7_Yr10",
                 "index_DR_ALL", "index_QYZ_ALL", "index_ZP_ALL", "index_CSI300",
                 "index_firstLevelBondFund", "index_secondLevelBondFund", 
                 "index_Exchange_HY");
  startDate  <- weekDate;
  endDate    <- date;
  indexDf    <- bloomberg.market.getData(names = indexes,yearDate, endDate);
  indexDf    <- na.locf(indexDf);

  ## 将列名改成中文名
  keyMapDf <- data.frame(ChiName = c("可转债","1-3年国债","3-5年国债","5-7年国债",
                                     "7-10年国债","1-3年金融债","3-5年金融债",
                                     "5-7年金融债", "7-10年金融债", "金融债","短融","1年以内短融","企业债",
                                     "1-3年企业债","3-5年企业债","5-7年企业债","7-10年企业债","中票","1-3年中票",
                                     "3-5年中票","5-7年中票","7-10年中票","沪深300指数","一级债基","二级债基","交易所高收益债"
                                     ),
                         EngName = c("index_ConvertibleBond","index_GZ_Yr1_Yr3","index_GZ_Yr3_Yr5","index_GZ_Yr5_Yr7",
                                     "index_GZ_Yr7_Yr10","index_JR_Yr1_Yr3","index_JR_Yr3_Yr5","index_JR_Yr5_Yr7",
                                     "index_JR_Yr7_Yr10","index_JR_ALL","index_DR_ALL","index_DR_Yr0_Yr1","index_QYZ_ALL",
                                     "index_QYZ_Yr1_Yr3","index_QYZ_Yr3_Yr5","index_QYZ_Yr5_Yr7","index_QYZ_Yr7_Yr10",
                                     "index_ZP_ALL","index_ZP_Yr1_Yr3","index_ZP_Yr3_Yr5","index_ZP_Yr5_Yr7","index_ZP_Yr7_Yr10",
                                     "index_CSI300","index_firstLevelBondFund","index_secondLevelBondFund", "index_Exchange_HY"));
  colnames(indexDf)       <- keyMapDf$ChiName[match(colnames(indexDf), keyMapDf$EngName)];

### Week performance

  png("/home/amg/git/blog.wtmart.com/source/images/assetWeek.png",width=1000,height=500);
  tmpDf                   <-  indexDf[time(indexDf)>=date.convert(weekDate), ];
  tmpDf                   <- 100 * sweep(tmpDf,2,as.vector(tmpDf[1,]),FUN = "/");
  tmpDf                   <- tmpDf[nrow(tmpDf), ] / as.vector(tmpDf[1, ]) - 1;
  tmpDf                   <- as.matrix(100 * tmpDf);
  indexVec                <- as.vector(tmpDf[1,]);
  names(indexVec)         <- colnames(indexDf);
  indexVec                <- indexVec[order(indexVec, decreasing = TRUE)];
  mp                      <- barplot(indexVec,horiz = FALSE, xaxt="n");
  labs                    <- names(indexVec);
  text(cex=.8, x=mp-.25, y=min(min(indexVec)/2,0), labs, xpd=TRUE, srt=45);
  abline(h = 0);
  colVecs <- ifelse(indexVec>0, "red", "blue");         
  text(mp, 1.1 * indexVec, p(round(indexVec,2),"%"), xpd = TRUE, col = colVecs);  
  dev.off();

### Month performance

  png("/home/amg/git/blog.wtmart.com/source/images/assetMonth.png",width=1000,height=500);
  tmpDf                   <-  indexDf[time(indexDf)>=date.convert(monthDate), ];
  tmpDf                   <- 100 * sweep(tmpDf,2,as.vector(tmpDf[1,]),FUN = "/");
  tmpDf                   <- tmpDf[nrow(tmpDf), ] / as.vector(tmpDf[1, ]) - 1;
  tmpDf                   <- as.matrix(100 * tmpDf);
  indexVec                <- as.vector(tmpDf[1,]);
  names(indexVec)         <- colnames(indexDf);
  indexVec                <- indexVec[order(indexVec, decreasing = TRUE)];
  mp                      <- barplot(indexVec,horiz = FALSE, xaxt="n");
  labs                    <- names(indexVec);
  text(cex=.8, x=mp-.25, y=min(min(indexVec)/2,0), labs, xpd=TRUE, srt=45);
  abline(h = 0);
  colVecs <- ifelse(indexVec>0, "red", "blue");         
  text(mp, 1.1 * indexVec, p(round(indexVec,2),"%"), xpd = TRUE, col = colVecs);  
  dev.off();

### Year performance

  png("/home/amg/git/blog.wtmart.com/source/images/assetYear.png",width=1000,height=500);
  tmpDf                   <-  indexDf[time(indexDf)>=date.convert(yearDate), ];
  tmpDf                   <- 100 * sweep(tmpDf,2,as.vector(tmpDf[1,]),FUN = "/");
  tmpDf                   <- tmpDf[nrow(tmpDf), ] / as.vector(tmpDf[1, ]) - 1;
  tmpDf                   <- as.matrix(100 * tmpDf);
  indexVec                <- as.vector(tmpDf[1,]);
  names(indexVec)         <- colnames(indexDf);
  indexVec                <- indexVec[order(indexVec, decreasing = TRUE)];
  mp                      <- barplot(indexVec,horiz = FALSE, xaxt="n");
  labs                    <- names(indexVec);
  text(cex=.8, x=mp-.25, y=min(min(indexVec)/2,0), labs, xpd=TRUE, srt=45);
  abline(h = 0);
  colVecs <- ifelse(indexVec>0, "red", "blue");         
  text(mp, 1.1 * indexVec, p(round(indexVec,2),"%"), xpd = TRUE, col = colVecs);  
  dev.off();


```
**图 9：大类资产表现（近一周）** 
* ------------------------------------- *
![债券市场回顾](/images/assetWeek.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统

**图 10：大类资产表现（近一月） ** 
* ------------------------------------- *
![债券市场回顾](/images/assetMonth.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统

**图 11：大类资产表现（年初至今） ** 
* ------------------------------------- *
![债券市场回顾](/images/assetYear.png)
* ------------------------------------- *
资料来源：Wind,COS Inv系统
